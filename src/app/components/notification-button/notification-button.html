<button
  class="hidden sm:inline-flex h-9 w-9 items-center justify-center rounded-md border border-zinc-800 bg-zinc-900/80 text-zinc-300 hover:bg-zinc-800 hover:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer relative"
  aria-label="Notifications"
  (click)="togglePopUp()"
>
  @if (unreadCount) {
  <span
    class="rounded-full w-4 bg-indigo-500 aspect-square absolute -top-2 -right-2 flex items-center justify-center text-xs font-semibold text-white"
    id="notification-badge"
  >
    {{ unreadCount }}
  </span>
  }
  <svg class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor">
    <path
      d="M12 22a2.5 2.5 0 0 0 2.45-2h-4.9A2.5 2.5 0 0 0 12 22Zm6-6v-5a6 6 0 0 0-12 0v5l-2 2v1h16v-1l-2-2Z"
    />
  </svg>
</button>

@if (isPopUpOpen()) {
<div
  class="absolute right-15 top-15 bg-zinc-900 rounded-xl p-4 mt-2 w-80 max-h-[600px] overflow-y-auto shadow-lg"
  id="notification-popup"
>
  <h3 class="text-lg font-medium text-white mb-2">Notifications</h3>
  <ul class="max-h-60 overflow-y-auto">
    <h4>New</h4>
    @if (unreadNotifications.length === 0) {
    <li class="text-zinc-400 my-4">No new notifications</li>
    } @else { @for (notification of unreadNotifications; track notification.id; let i = $index) {
    <li class="mb-2 p-2 bg-zinc-800 rounded-md">
      <p class="text-sm text-zinc-300">{{ notification.message }}</p>
      <span class="text-xs text-zinc-500">{{ notification.timestamp }}</span>

      @if (!notification.read) {
      <button
        (click)="markAsRead(notification)"
        class="w-full flex items-center justify-end text-xs text-indigo-400 hover:underline mt-1"
      >
        Mark as read
      </button>
      }
    </li>
    } }
  </ul>

  <ul class="max-h-60 overflow-y-auto">
    <h4>Read</h4>
    @if (readNotifications.length === 0) {
    <li class="text-zinc-400">No new notifications</li>
    } @else { @for (notification of readNotifications; track notification.id; let i = $index) {
    <li class="mb-2 p-2 bg-zinc-800 rounded-md">
      <p class="text-sm text-zinc-300">{{ notification.message }}</p>
      <span class="text-xs text-zinc-500">{{ notification.timestamp }}</span>
    </li>
    } }
  </ul>
</div>
}
