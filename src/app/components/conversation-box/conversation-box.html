<form class="w-full flex flex-col items-center text-white h-full z-10">
  <!-- This needs to change to chatId when backend is integrated -->
  @if (messages.length) { @if (isGroupChat) {
  <header
    class="flex flex-col w-full rounded-xl mt-2 h-16 px-4 py-2 z-10 bg-zinc-900 text-zinc-100 border-b border-zinc-800"
  >
    <h2 class="text-lg font-semibold truncate">
      {{ chatTitle }}
    </h2>
    @if (chatMemberCount) {
    <span>{{ chatMemberCount }} members</span>
    }
  </header>
  }

  <div class="flex flex-col w-full justify-between h-full z-10">
    <!-- message container -->
    <div class="w-full py-4 flex-1 overflow-y-auto px-2">
      <ul class="space-y-4 flex flex-col gap-2">
        @for (m of messages!; track m.id) {
        <app-message-bubble
          [sender]="m.sender"
          [isGroupChat]="isGroupChat"
          [content]="m.content"
          [timestamp]="m.timestamp"
          [avatarUrl]="m.avatarUrl ?? ''"
          [chatMemberColor]="getChatMemberColor(m.sender)"
        >
        </app-message-bubble>
        }
      </ul>
    </div>

    <div class="w-full flex flex-col justify-end">
      <!-- Type message component -->
      <div class="flex items-center gap-2 w-full p-4 rounded-2xl">
        <input
          type="text"
          placeholder="Type your message..."
          class="flex-1 rounded-2xl bg-zinc-800/50 border border-zinc-700 outline-none py-2 px-4 placeholder:text-white placeholder:opacity-50"
        />
        <button
          class="bg-linear-to-r p-2 px-3 md:px-4 from-blue-800 to-indigo-900 rounded-xl font-semibold cursor-pointer"
          type="submit"
        >
          Send
        </button>
      </div>
    </div>
  </div>

  <div class="absolute inset-0 opacity-25 active-conversation-box pointer-events-none"></div>
  <!-- Diagonal Cross Grid Top Background -->

  } @else {
  <div class="flex flex-col items-center justify-center h-full z-10 text-white gap-4">
    <svg
      class="h-16 w-16 text-white"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      viewBox="0 0 24 24"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"
      ></path>
    </svg>
    <p class="text-center">Select a chat to start messaging</p>
  </div>
  <div
    class="absolute inset-0 pointer-events-none opacity-15"
    style="
      background-image: linear-gradient(
          45deg,
          transparent 49%,
          #4a7ada 49%,
          #4a7ada 51%,
          transparent 51%
        ),
        linear-gradient(-45deg, transparent 49%, #4a7ada 49%, #4a7ada 51%, transparent 51%);
      background-size: 40px 40px;
      -webkit-mask-image: radial-gradient(ellipse 70% 60% at 50% 0%, #000 60%, transparent 100%);
      mask-image: radial-gradient(ellipse 70% 60% at 50% 0%, #000 60%, transparent 100%);
    "
  ></div>
  }
</form>
